import uml;

extension common::nameNormalizer;

List[uml::Property] allTaggedValues(uml::Class this):
	let result = (List[uml::Property]) {} : (
		result.addAll(this.ownedElement.typeSelect(uml::Property).select(e|e.isValidTaggedValue())) ->
		result.addAll(this.allParents().ownedElement.typeSelect(uml::Property).select(e|e.isValidTaggedValue()))
	) ->
	
	result	
;

List[String] allTaggedValueNames(uml::Class this):
	this.allTaggedValues().name
;

boolean isValidTaggedValue(uml::Property this):
	this != null &&
	this.name != "" &&
	this.association.metaType != uml::Extension
;

uml::Class getMetaClass(uml::Class this):
	this.getAssociations().typeSelect(uml::Extension).memberEnd.select(e|e.type != this).first().type
	//this.getAllExtendedMetaclasses().first()
;

String getCwmName(uml::Class this):
	switch(this.name) {
		case "ChiActivity":
			"Activity"
		
		default:
			this.name
	}
;

uml::Type getTaggedValueType(uml::Class this, String taggedValueName):
	this.allTaggedValues().select(e|e.name == taggedValueName).type.first()
;

String getTaggedValueName(String this):
	this
;

String getCwmPropertyName(String this):
	let result = this.normalizeMemberName():
	switch (result) {
		default:
			result
	}
;
