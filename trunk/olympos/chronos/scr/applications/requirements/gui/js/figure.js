
/*
 This file was generated by wCMFGenerator 2.6.1.0016 from model/requirements.xmi on 02.09.08 21:48.
 Manual modifications should be placed inside the protected regions.
 developer: Giuseppe Platania
 Version: 1.0
 Class: class.ChiGoal.js
 Description: a Measurable scope that the enterprise wants to achieve.
 */
cwm.figure.ChiGoal = function(label, oid, parentoids, childoids){

	//Changed: cwm --> uwm
	uwm.figure.RectFigure.call(this, "ChiGoal", label, oid, parentoids, childoids);
}

cwm.figure.ChiGoal.prototype = new uwm.figure.RectFigure;

cwm.figure.ChiGoal.prototype.type = "cwm.figure.ChiGoal";

//Changed 2008-09-03: Added function
cwm.figure.ChiGoal.prototype.getDescription = function(){
	return "A measurable scope that the enterprise wants to achieve.";
}

//Changed 2008-09-04: Added function
cwm.figure.ChiGoal.prototype.getLabel = function(newLabels){
	return newLabels.Name + " - " + newLabels.Priority;
}

//Changed 2008-09-04: Added function
cwm.figure.ChiGoal.prototype.setRecordLabel = function(record, newLabels){
	record.set("Name", newLabels.Name);
	record.set("Priority", newLabels.Priority);
}

cwm.figure.ChiGoal.prototype.getGrid = function(store){
	return new Ext.grid.GridPanel({
		id: "GridChiGoal",
		iconCls: "FigureGraphic FigureChiGoal",
		layout: "fit",
		columns: [{
			header: "ChiGoal",
			dataIndex: "Name",
			sortable: true
		}, {
			header: "parentoids",
			dataIndex: "parentoids",
			hidden: true,
			hideable: false
		}, {
			header: "childoids",
			dataIndex: "childoids",
			hidden: true,
			hideable: false
		}],
		store: store,
		enableDragDrop: true,
		selModel: new Ext.grid.RowSelectionModel({
			singleSelect: true
		}),
		ddGroup: "gridDDGroup",
		uwmClassName: "ChiGoal",
		listeners: {
			cellclick: function(grid, rowIndex, columnIndex, e){
				uwm.showProperties(grid.uwmClassName, grid.getStore().getAt(rowIndex).id);
			},
			rowcontextmenu: function(grid, rowIndex, e){
				var node = grid.getStore().getAt(rowIndex);
				
				var contextMenu = new Ext.menu.Menu({
					items: [new Ext.menu.Item({
						text: "Show in diagram",
						handler: function(item, e){
							var oid = node.id;
							uwm.showInDiagram(oid);
						},
						disabled: !uwm.getByOid(node.id)
					}), new Ext.menu.Item({
						text: "Show in Tree",
						handler: function(item, e){
							var oid = node.id;
							
							uwm.showInTree(oid);
						}
					}), "-", {
						text: "Delete from model",
						handler: function(){
							var record = grid.getStore().getAt(rowIndex);
							
							grid.getStore().remove(record);
							//Changed 2008-09-04: Added "ChiGoal"
							uwm.deleteFigureFromModel("ChiGoal", record.id);
						}
					}]
				});
				
				//Change 2008-09-03
				contextMenu.showAt([e.getXY()[0] + 2, e.getXY()[1] + 2]);
				
				e.preventDefault();
			}
			
			
		}
	});
}


cwm.figure.ChiGoal.prototype.getStore = function(){
	return new Ext.data.Store({
		url: uwm.config.jsonUrl,
		baseParams: {
			sid: uwm.data.sid,
			usr_action: "list",
			response_format: "JSON",
			type: "ChiGoal"
		},
		reader: new Ext.data.JsonReader({
			totalProperty: "totalCount",
			root: "objects",
			id: "oid",
			fields: [{
				name: "Name",
				mapping: "values[1].Name"
			}, {
				name: "parentoids",
				//Change: removed properties.
				mapping: "parentoids"
			}, {
				name: "childoids",
				//Change: removed properties.
				mapping: "childoids"
			}]
		})
	});
}

cwm.figure.ChiGoal.prototype.showEdit = function(parentComponent, oid){

	Ext.form.Field.prototype.msgTarget = 'side';
	var listeners = {
		"change": function(field, newValue, oldValue){
			uwm.fieldChanged(field, newValue, oldValue, oid);
		}
	};
	var htmlListeners = {
		"sync": function(field, html){
			field.contentChanged = true;
		},
		"beforedestroy": function(field){
			if (field.contentChanged) {
				uwm.fieldChanged(field, field.getValue(), null, oid);
			}
		}
	};
	var form = new Ext.FormPanel({
		oid: oid,
		labelWidth: 90,
		frame: true,
		labelAlign: "top",
		title: 'ChiGoal Edit View',
		defaults: {
			width: 222
		},
		defaultType: 'textfield',
		items: [{
			fieldLabel: 'Priority',
			name: 'Priority',
			
			inputType: 'textfield',
			listeners: {
				"change": function(field, newValue, oldValue){
					uwm.fieldChanged(field, newValue, oldValue, oid);
					uwm.updateElementDisplay(oid, "ChiGoal", "labelChange", {
						Name: form.getForm().findField("Name").getValue(),
						Priority: newValue
					});
				}
			}
		
		}, {
			fieldLabel: 'Value_Name',
			name: 'Value_Name',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Value_ammount',
			name: 'Value_ammount',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Value_Goal',
			name: 'Value_Goal',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Alias',
			name: 'Alias',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Version',
			name: 'Version',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Name',
			name: 'Name',
			
			inputType: 'textfield',
			listeners: {
				"change": function(field, newValue, oldValue){
					uwm.fieldChanged(field, newValue, oldValue, oid);
					uwm.updateElementDisplay(oid, "ChiGoal", "labelChange", {
						Name: newValue,
						Priority: form.getForm().findField("Priority").getValue()
					});
				}
			}
		}, // TODO check this manually
 new Ext.form.HtmlEditor({
			fieldLabel: 'Notes',
			name: 'Notes',
			enableAlignments: false,
			enableColors: false,
			enableFont: false,
			enableFontSize: false,
			enableLinks: false,
			enableSourceEdit: false,
			listeners: htmlListeners
			//Change: removed one comma
		}), {
			fieldLabel: 'created',
			name: 'created',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'creator',
			name: 'creator',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'last_editor',
			name: 'last_editor',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'modified',
			name: 'modified',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}]
	});
	
	parentComponent.add(form);
	parentComponent.doLayout();
	
	
	uwm.jsonRequest({
		usr_action: "display",
		oid: oid,
		depth: 0,
		omitMetaData: true
	}, "Loading properties", function(data){
		var realForm = form.getForm();
		
		realForm.findField("Priority").setValue(data.node.values[1].Priority);
		realForm.findField("Value_Name").setValue(data.node.values[1].Value_Name);
		realForm.findField("Value_ammount").setValue(data.node.values[1].Value_ammount);
		realForm.findField("Value_Goal").setValue(data.node.values[1].Value_Goal);
		realForm.findField("Alias").setValue(data.node.values[1].Alias);
		realForm.findField("Version").setValue(data.node.values[1].Version);
		realForm.findField("Name").setValue(data.node.values[1].Name);
		realForm.findField("Notes").setValue(data.node.values[1].Notes);
		realForm.findField("created").setValue(data.node.values[1].created);
		realForm.findField("creator").setValue(data.node.values[1].creator);
		realForm.findField("last_editor").setValue(data.node.values[1].last_editor);
		realForm.findField("modified").setValue(data.node.values[1].modified);
	});
};
cwm.figure.ChiGoal.prototype.getConstraints = function(){
	return {
	
		ChiGoal: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		Package: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		ChiBusinessProcess: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		ChiRequirement: {
			label: "defines",
			inverse: true,
			ConnectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "child"
		},
		
		ChiGoal: {
			label: "defines",
			inverse: true,
			ConnectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "child"
		}
	
	};
}


/*
 This file was generated by wCMFGenerator 2.6.1.0019 from model/requirements.xmi on 04.09.08 16:02. 
  Manual modifications should be placed inside the protected regions.
   developer: Giuseppe Platania
   Version: 1.0
   Class: class.ChiRequirement.js
   Description: A Business guide line about the Enterprise or the project.
  */
  
cwm.figure.ChiRequirement = function(label, oid, parentoids, childoids){

	uwm.figure.RectFigure.call(this, "ChiRequirement", label, oid, parentoids, childoids);
}

cwm.figure.ChiRequirement.prototype = new uwm.figure.RectFigure;

cwm.figure.ChiRequirement.prototype.type = "cwm.figure.ChiRequirement";

cwm.figure.ChiRequirement.prototype.getDescription = function() {
	return "A Business guide line about the Enterprise or the project.";
}

cwm.figure.ChiRequirement.prototype.getGrid = function(store) {
	return new Ext.grid.GridPanel({
	id: "GridChiRequirement",
		iconCls: "FigureGraphic FigureChiRequirement",
		layout: "fit",
					columns: [
					
						{
						header: "Name",
						dataIndex: "Name",
						sortable: true
					},
						{
						header: "Priority",
						dataIndex: "Priority",
						sortable: true
					},

					{
					header: "parentoids",
					dataIndex: "parentoids",
					hidden: true,
					hideable: false
				}, {
					header: "childoids",
					dataIndex: "childoids",
					hidden: true,
					hideable: false
				}],
					store: store,
					enableDragDrop: true,
					selModel: new Ext.grid.RowSelectionModel({
						singleSelect: true
					}),
					ddGroup: "gridDDGroup",
					uwmClassName: "ChiRequirement",
					listeners: {
								cellclick: function(grid, rowIndex, columnIndex, e) {
								uwm.showProperties(grid.uwmClassName, grid.getStore().getAt(rowIndex).id);
								},
								cellcontextmenu: function(grid, rowIndex, columnIndex, e){
								var node = grid.getStore().getAt(rowIndex);
				
							var contextMenu = new Ext.menu.Menu({
								items: [new Ext.menu.Item({
									text: "Show in diagram",
									handler: function(item, e){
										var oid = node.id;							
										uwm.showInDiagram(oid);
															},
						disabled: !uwm.getByOid(node.id)
					}), new Ext.menu.Item({
						text: "Show in Tree",
						handler: function(item, e){
							var oid = node.id;
							
							uwm.showInTree(oid);
						}
					}), "-", {
						text: "Delete from model",
						handler: function(){
							var record = grid.getStore().getAt(rowIndex);
							
							grid.getStore().remove(record);
							uwm.deleteFigureFromModel("ChiRequirement", record.id);
						}
					}]
				});
				
				contextMenu.showAt([e.getXY()[0] + 2, e.getXY()[1] + 2]);				
				e.preventDefault();
			}
		}
	});
}

cwm.figure.ChiRequirement.prototype.getStore = function(){
	return new Ext.data.Store({
		url: uwm.config.jsonUrl,
		baseParams: {
			sid: uwm.data.sid,
			usr_action: "list",
			response_format: "JSON",
			type: "ChiRequirement"
		},
		reader: new Ext.data.JsonReader({
			totalProperty: "totalCount",
			root: "objects",
			id: "oid",
			fields: [
			
			{
				name: "Name",
				mapping: "values[1].Name"
			},
			{
				name: "Priority",
				mapping: "values[1].Priority"
			},

			 {
				name: "parentoids",
				mapping: "parentoids"
			}, {
				name: "childoids",
				mapping: "childoids"
			}]
		})
	});
}

cwm.figure.ChiRequirement.prototype.showEdit = function(parentComponent, oid){

	Ext.form.Field.prototype.msgTarget = 'side';
	var listeners = {
		"change": function(field, newValue, oldValue){
			uwm.fieldChanged(field, newValue, oldValue, oid);
			uwm.updateElementDisplay(oid, "ChiRequirement")
		}
	};
	var htmlListeners = {
						"sync": function(field, html){
						field.contentChanged = true;
						},
						"beforedestroy": function(field){
														if (field.contentChanged) {
																				uwm.fieldChanged(field, field.getValue(), null, oid);
																					}
														}
						};	
	var form = new Ext.FormPanel({	
		oid: oid,
		labelWidth: 90,	
		frame: true,
		labelAlign: "top",
		title: 'ChiRequirement Edit View',
		autoScroll: true,
		defaults: {
			width: 222
		},
		defaultType: 'textfield',
		items: [
				
new Ext.form.ComboBox({
			fieldLabel: 'reqType',
			 id: 'IDreqType',
			name: 'reqType',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiRequirementType"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}) 

,

			{	
			fieldLabel: 'Priority',
	        name: 'Priority',
	        id: 'IDPriority',
	        
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

new Ext.form.ComboBox({
			fieldLabel: 'Author',
			 id: 'IDAuthor',
			name: 'Author',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}) 

,

new Ext.form.ComboBox({
			fieldLabel: 'Proofreader',
			 id: 'IDProofreader',
			name: 'Proofreader',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}) 

,

new Ext.form.ComboBox({
			fieldLabel: 'Status',
			 id: 'IDStatus',
			name: 'Status',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiRequirementStatus"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}) 

,

			{	
			fieldLabel: 'Alias',
	        name: 'Alias',
	        id: 'IDAlias',
	        
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			{	
			fieldLabel: 'Version',
	        name: 'Version',
	        id: 'IDVersion',
	        
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			{	
			fieldLabel: 'Name',
	        name: 'Name',
	        id: 'IDName',
	        
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			// TODO check this manually
			new Ext.form.HtmlEditor({
			fieldLabel: 'Notes',
			name: 'Notes',
			id: 'IDNotes',
			enableAlignments: false,
			enableColors: false,
			enableFont: false,
			enableFontSize: false,
			enableLinks: false,
			enableSourceEdit: false,			
			listeners: htmlListeners
		})
,

			{	
			fieldLabel: 'created',
	        name: 'created',
	        id: 'IDcreated',
	        readOnly:true,
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			{	
			fieldLabel: 'creator',
	        name: 'creator',
	        id: 'IDcreator',
	        readOnly:true,
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			{	
			fieldLabel: 'last_editor',
	        name: 'last_editor',
	        id: 'IDlast_editor',
	        readOnly:true,
	         inputType:'textfield',
	        listeners: listeners 
	        }
,

			{	
			fieldLabel: 'modified',
	        name: 'modified',
	        id: 'IDmodified',
	        readOnly:true,
	         inputType:'textfield',
	        listeners: listeners 
	        }


			]
	});
	
	parentComponent.add(form);
	parentComponent.doLayout();
	   new Ext.ToolTip({
        target: 'IDPriority',
        html: "A priority in %. Requirements are ordered by priority."
    });
	   new Ext.ToolTip({
        target: 'IDAuthor',
        html: "This requirement's author's name and role in the project"
    });
	   new Ext.ToolTip({
        target: 'IDProofreader',
        html: "Each requirement needs to be confirmed.This requirement's proofreader's name and role in the project"
    });



	uwm.jsonRequest({
		usr_action: "display",
		oid: oid,
		depth: 0,
		omitMetaData: true
		}, 
		"Loading properties", function(data){
		var realForm = form.getForm();			
			
			realForm.findField("reqType").setValue(data.node.values[1].reqType);
			realForm.findField("Priority").setValue(data.node.values[1].Priority);
			realForm.findField("Author").setValue(data.node.values[1].Author);
			realForm.findField("Proofreader").setValue(data.node.values[1].Proofreader);
			realForm.findField("Status").setValue(data.node.values[1].Status);
			realForm.findField("Alias").setValue(data.node.values[1].Alias);
			realForm.findField("Version").setValue(data.node.values[1].Version);
			realForm.findField("Name").setValue(data.node.values[1].Name);
			realForm.findField("Notes").setValue(data.node.values[1].Notes);
			realForm.findField("created").setValue(data.node.values[1].created);
			realForm.findField("creator").setValue(data.node.values[1].creator);
			realForm.findField("last_editor").setValue(data.node.values[1].last_editor);
			realForm.findField("modified").setValue(data.node.values[1].modified);		
	});
};
cwm.figure.ChiRequirement.prototype.getConstraints = function() {
	return {
				
		Package: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"parent"
		},			
		ChiRequirement: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"parent"
		},			
		ChiGoal: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"parent"
		},			
		ChiBusinessProcess: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"parent"
		},
		ChiIssue: {
			label: "defines",
			inverse: true,
			connectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"child"
		},
		
		ChiRequirement: {
			label: "defines",
			inverse: true,
			connectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"child"
		},
		
		NMFeatureRequirements: {
			label: "defines",
			inverse: true,
			connectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship:"child"
		}
		
	};
}


/*
 This file was generated by wCMFGenerator 2.6.1.0016 from model/requirements.xmi on 02.09.08 21:48.
 Manual modifications should be placed inside the protected regions.
 developer: Giuseppe Platania
 Version: 1.0
 Class: class.ChiIssue.js
 Description:
 */
cwm.figure.ChiIssue = function(label, oid, parentoids, childoids){

	uwm.figure.RectFigure.call(this, "ChiIssue", label, oid, parentoids, childoids);
}

cwm.figure.ChiIssue.prototype = new uwm.figure.RectFigure;

cwm.figure.ChiIssue.prototype.type = "cwm.figure.ChiIssue";

cwm.figure.ChiIssue.prototype.getGrid = function(store){
	return new Ext.grid.GridPanel({
		id: "GridChiIssue",
		iconCls: "FigureGraphic FigureChiIssue",
		layout: "fit",
		columns: [{
			header: "ChiIssue",
			dataIndex: "Name",
			sortable: true
		}, {
			header: "parentoids",
			dataIndex: "parentoids",
			hidden: true,
			hideable: false
		}, {
			header: "childoids",
			dataIndex: "childoids",
			hidden: true,
			hideable: false
		}],
		store: store,
		enableDragDrop: true,
		selModel: new Ext.grid.RowSelectionModel({
			singleSelect: true
		}),
		ddGroup: "gridDDGroup",
		uwmClassName: "ChiIssue",
		listeners: {
			cellclick: function(grid, rowIndex, columnIndex, e){
				uwm.showProperties(grid.uwmClassName, grid.getStore().getAt(rowIndex).id);
			},
			cellcontextmenu: function(grid, rowIndex, columnIndex, e){
				var node = grid.getStore().getAt(rowIndex);
				
				var contextMenu = new Ext.menu.Menu({
					items: [new Ext.menu.Item({
						text: "Show in diagram",
						handler: function(item, e){
							var oid = node.id;
							uwm.showInDiagram(oid);
						},
						disabled: !uwm.getByOid(node.id)
					}), new Ext.menu.Item({
						text: "Show in Tree",
						handler: function(item, e){
							var oid = node.id;
							
							uwm.showInTree(oid);
						}
					}), "-", {
						text: "Delete from model",
						handler: function(){
							var record = grid.getStore().getAt(rowIndex);
							
							grid.getStore().remove(record);
							uwm.deleteFigureFromModel("ChiIssue", record.id);
						}
					}]
				});
				
				contextMenu.showAt(e.getXY());
				e.stopPropagation();
				return false;
			}
		}
	});
}


cwm.figure.ChiIssue.prototype.getStore = function(){
	return new Ext.data.Store({
		url: uwm.config.jsonUrl,
		baseParams: {
			sid: uwm.data.sid,
			usr_action: "list",
			response_format: "JSON",
			type: "ChiIssue"
		},
		reader: new Ext.data.JsonReader({
			totalProperty: "totalCount",
			root: "objects",
			id: "oid",
			fields: [{
				name: "Name",
				mapping: "values[1].Name"
			}, {
				name: "parentoids",
				mapping: "parentoids"
			}, {
				name: "childoids",
				mapping: "childoids"
			}]
		})
	});
}

cwm.figure.ChiIssue.prototype.showEdit = function(parentComponent, oid){

	Ext.form.Field.prototype.msgTarget = 'side';
	var listeners = {
		"change": function(field, newValue, oldValue){
			uwm.fieldChanged(field, newValue, oldValue, oid);
		}
	};
	var htmlListeners = {
		"sync": function(field, html){
			field.contentChanged = true;
		},
		"beforedestroy": function(field){
			if (field.contentChanged) {
				uwm.fieldChanged(field, field.getValue(), null, oid);
			}
		}
	};
	var form = new Ext.FormPanel({
		oid: oid,
		labelWidth: 90,
		frame: true,
		labelAlign: "top",
		title: 'ChiIssue Edit View',
		autoScroll: true,
		defaults: {
			width: 222
		},
		defaultType: 'textfield',
		items: [new Ext.form.ComboBox({
			fieldLabel: 'Author',
			name: 'Author',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}), new Ext.form.ComboBox({
			fieldLabel: 'Responsible',
			name: 'Responsible',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}), {
			fieldLabel: 'Alias',
			name: 'Alias',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Version',
			name: 'Version',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Name',
			name: 'Name',
			
			inputType: 'textfield',
			listeners: listeners
		}, // TODO check this manually
 new Ext.form.HtmlEditor({
			fieldLabel: 'Notes',
			name: 'Notes',
			enableAlignments: false,
			enableColors: false,
			enableFont: false,
			enableFontSize: false,
			enableLinks: false,
			enableSourceEdit: false,
			listeners: htmlListeners
		}), {
			fieldLabel: 'created',
			name: 'created',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'creator',
			name: 'creator',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'last_editor',
			name: 'last_editor',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'modified',
			name: 'modified',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}]
	});
	
	parentComponent.add(form);
	parentComponent.doLayout();
	
	
	uwm.jsonRequest({
		usr_action: "display",
		oid: oid,
		depth: 0,
		omitMetaData: true
	}, "Loading properties", function(data){
		var realForm = form.getForm();
		
		realForm.findField("Author").setValue(data.node.values[1].Author);
		realForm.findField("Responsible").setValue(data.node.values[1].Responsible);
		realForm.findField("Alias").setValue(data.node.values[1].Alias);
		realForm.findField("Version").setValue(data.node.values[1].Version);
		realForm.findField("Name").setValue(data.node.values[1].Name);
		realForm.findField("Notes").setValue(data.node.values[1].Notes);
		realForm.findField("created").setValue(data.node.values[1].created);
		realForm.findField("creator").setValue(data.node.values[1].creator);
		realForm.findField("last_editor").setValue(data.node.values[1].last_editor);
		realForm.findField("modified").setValue(data.node.values[1].modified);
	});
};
cwm.figure.ChiIssue.prototype.getConstraints = function(){
	return {
	
		ChiRequirement: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		Package: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		ChiBusinessProcess: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
	};
}

/*
 This file was generated by wCMFGenerator 2.6.1.0016 from model/requirements.xmi on 02.09.08 21:48.
 Manual modifications should be placed inside the protected regions.
 developer: Giuseppe Platania
 Version: 1.0
 Class: class.ChiFeature.js
 Description:
 */
cwm.figure.ChiFeature = function(label, oid, parentoids, childoids){

	uwm.figure.RectFigure.call(this, "ChiFeature", label, oid, parentoids, childoids);
}

cwm.figure.ChiFeature.prototype = new uwm.figure.RectFigure;

cwm.figure.ChiFeature.prototype.type = "cwm.figure.ChiFeature";

cwm.figure.ChiFeature.prototype.getGrid = function(store){
	return new Ext.grid.GridPanel({
		id: "GridChiFeature",
		iconCls: "FigureGraphic FigureChiFeature",
		layout: "fit",
		columns: [{
			header: "ChiFeature",
			dataIndex: "Name",
			sortable: true
		}, {
			header: "parentoids",
			dataIndex: "parentoids",
			hidden: true,
			hideable: false
		}, {
			header: "childoids",
			dataIndex: "childoids",
			hidden: true,
			hideable: false
		}],
		store: store,
		enableDragDrop: true,
		selModel: new Ext.grid.RowSelectionModel({
			singleSelect: true
		}),
		ddGroup: "gridDDGroup",
		uwmClassName: "ChiFeature",
		listeners: {
			cellclick: function(grid, rowIndex, columnIndex, e){
				uwm.showProperties(grid.uwmClassName, grid.getStore().getAt(rowIndex).id);
			},
			cellcontextmenu: function(grid, rowIndex, columnIndex, e){
				var node = grid.getStore().getAt(rowIndex);
				
				var contextMenu = new Ext.menu.Menu({
					items: [new Ext.menu.Item({
						text: "Show in diagram",
						handler: function(item, e){
							var oid = node.id;
							uwm.showInDiagram(oid);
						},
						disabled: !uwm.getByOid(node.id)
					}), new Ext.menu.Item({
						text: "Show in Tree",
						handler: function(item, e){
							var oid = node.id;
							
							uwm.showInTree(oid);
						}
					}), "-", {
						text: "Delete from model",
						handler: function(){
							var record = grid.getStore().getAt(rowIndex);
							
							grid.getStore().remove(record);
							uwm.deleteFigureFromModel("ChiFeature", record.id);
						}
					}]
				});
				
				contextMenu.showAt(e.getXY());
				e.stopPropagation();
				return false;
			}
		}
	});
}


cwm.figure.ChiFeature.prototype.getStore = function(){
	return new Ext.data.Store({
		url: uwm.config.jsonUrl,
		baseParams: {
			sid: uwm.data.sid,
			usr_action: "list",
			response_format: "JSON",
			type: "ChiFeature"
		},
		reader: new Ext.data.JsonReader({
			totalProperty: "totalCount",
			root: "objects",
			id: "oid",
			fields: [{
				name: "Name",
				mapping: "values[1].Name"
			}, {
				name: "parentoids",
				mapping: "parentoids"
			}, {
				name: "childoids",
				mapping: "childoids"
			}]
		})
	});
}

cwm.figure.ChiFeature.prototype.showEdit = function(parentComponent, oid){

	Ext.form.Field.prototype.msgTarget = 'side';
	var listeners = {
		"change": function(field, newValue, oldValue){
			uwm.fieldChanged(field, newValue, oldValue, oid);
		}
	};
	var htmlListeners = {
		"sync": function(field, html){
			field.contentChanged = true;
		},
		"beforedestroy": function(field){
			if (field.contentChanged) {
				uwm.fieldChanged(field, field.getValue(), null, oid);
			}
		}
	};
	var form = new Ext.FormPanel({
		oid: oid,
		labelWidth: 90,
		frame: true,
		labelAlign: "top",
		title: 'ChiFeature Edit View',
		autoScroll: true,
		defaults: {
			width: 222
		},
		defaultType: 'textfield',
		items: [new Ext.form.ComboBox({
			fieldLabel: 'Author',
			name: 'Author',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}), new Ext.form.ComboBox({
			fieldLabel: 'Proofreader',
			name: 'Proofreader',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiAuthors"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}), new Ext.form.ComboBox({
			fieldLabel: 'Status',
			name: 'Status',
			store: new Ext.data.Store({
				url: uwm.config.jsonUrl,
				method: "POST",
				baseParams: {
					sid: uwm.data.sid,
					response_format: "JSON",
					usr_action: "listbox",
					// TODO extract the entity type manually
					type: "ChiFeatureStatus"
				},
				reader: new Ext.data.JsonReader({
					root: "objects",
					totalPorperty: "totalCount",
					id: "key"
				}, [{
					name: "key",
					mapping: "key"
				}, {
					name: "val",
					mapping: "val"
				}])
			}),
			displayField: 'val',
			valueField: 'key',
			mode: "remote",
			triggerAction: 'all',
			editable: false,
			listeners: listeners
		}), {
			fieldLabel: 'Alias',
			name: 'Alias',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Version',
			name: 'Version',
			
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'Name',
			name: 'Name',
			
			inputType: 'textfield',
			listeners: listeners
		}, // TODO check this manually
 new Ext.form.HtmlEditor({
			fieldLabel: 'Notes',
			name: 'Notes',
			enableAlignments: false,
			enableColors: false,
			enableFont: false,
			enableFontSize: false,
			enableLinks: false,
			enableSourceEdit: false,
			listeners: htmlListeners
		}), {
			fieldLabel: 'created',
			name: 'created',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'creator',
			name: 'creator',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'last_editor',
			name: 'last_editor',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}, {
			fieldLabel: 'modified',
			name: 'modified',
			readOnly: true,
			inputType: 'textfield',
			listeners: listeners
		}]
	});
	
	parentComponent.add(form);
	parentComponent.doLayout();
	
	
	uwm.jsonRequest({
		usr_action: "display",
		oid: oid,
		depth: 0,
		omitMetaData: true
	}, "Loading properties", function(data){
		var realForm = form.getForm();
		
		realForm.findField("Author").setValue(data.node.values[1].Author);
		realForm.findField("Proofreader").setValue(data.node.values[1].Proofreader);
		realForm.findField("Status").setValue(data.node.values[1].Status);
		realForm.findField("Alias").setValue(data.node.values[1].Alias);
		realForm.findField("Version").setValue(data.node.values[1].Version);
		realForm.findField("Name").setValue(data.node.values[1].Name);
		realForm.findField("Notes").setValue(data.node.values[1].Notes);
		realForm.findField("created").setValue(data.node.values[1].created);
		realForm.findField("creator").setValue(data.node.values[1].creator);
		realForm.findField("last_editor").setValue(data.node.values[1].last_editor);
		realForm.findField("modified").setValue(data.node.values[1].modified);
	});
};
cwm.figure.ChiFeature.prototype.getConstraints = function(){
	return {
	
		Package: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		ChiBusinessProcess: {
			label: "depends on",
			inverse: false,
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "parent"
		},
		NMFeatureRequirements: {
			label: "defines",
			inverse: true,
			ConnectionType: "aggregation",
			sourceMaxConns: -1,
			targetMaxConns: -1,
			relationship: "child"
		}
	
	};
}
